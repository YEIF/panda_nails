"use strict";(self["webpackChunkpanda_nails"]=self["webpackChunkpanda_nails"]||[]).push([[606],{908:function(e,s,t){function a(e){const s=new Date(1e3*e);return s.toLocaleDateString()}function l(e){const s=new Date(1e3*e),t=` ${s.getFullYear()}/${s.getMonth()+1}/${s.getDate()}  ${s.getHours()}:${s.getMinutes()}:${s.getSeconds()}`;return t}function n(e){const s=e.toString().split(".");return s[0]=s[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),s.join(".")}t.d(s,{D:function(){return a},lf:function(){return l},$E:function(){return n}})},143:function(e,s,t){t.d(s,{Z:function(){return u}});var a=t(6252);const l={class:"loadingio-spinner-spin-gw0b9unmls"},n=(0,a._)("div",{class:"ldio-jjk31xq51n"},[(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")]),(0,a._)("div",null,[(0,a._)("div")])],-1),i=[n];function o(e,s,t,n,o,c){return(0,a.wg)(),(0,a.iD)("div",l,i)}var c={},r=t(3744);const d=(0,r.Z)(c,[["render",o]]);var u=d},4427:function(e,s,t){t.d(s,{Z:function(){return w}});var a=t(6252),l=t(3577);const n={class:"list d-flex justify-content-center list-unstyled"},i=(0,a._)("i",{class:"bi bi-card-checklist fs-2"},null,-1),o=(0,a._)("p",{class:"mb-0 mb-lg-3"},"Step 1 .",-1),c=(0,a._)("p",null,"填寫資訊",-1),r=[i,o,c],d=(0,a._)("i",{class:"bi bi-credit-card fs-2"},null,-1),u=(0,a._)("p",{class:"mb-0 mb-lg-3"},"Step 2 .",-1),p=(0,a._)("p",null,"確認付款",-1),m=[d,u,p],f=(0,a._)("i",{class:"bi bi-cart-check fs-2"},null,-1),h=(0,a._)("p",{class:"mb-0 mb-lg-3"},"Step 3 .",-1),g=(0,a._)("p",null,"訂單完成",-1),_=[f,h,g];function b(e,s,t,i,o,c){return(0,a.wg)(),(0,a.iD)("ul",n,[(0,a._)("li",{class:(0,l.C_)(["rounded-circle d-flex flex-column justify-content-center text-nowrap",{active:t.stepStatus.createOrder}])},r,2),(0,a._)("li",{class:(0,l.C_)(["rounded-circle d-flex flex-column justify-content-center text-nowrap",{active:t.stepStatus.payCheck}])},m,2),(0,a._)("li",{class:(0,l.C_)(["rounded-circle d-flex flex-column justify-content-center text-nowrap",{active:t.stepStatus.success}])},_,2)])}var v={props:{stepStatus:{type:Object}}},y=t(3744);const x=(0,y.Z)(v,[["render",b]]);var w=x},606:function(e,s,t){t.r(s),t.d(s,{default:function(){return ge}});var a=t(6252),l=t(3577),n=t(9963);const i={class:"container mt-5"},o={key:0,class:"row mt-5"},c={class:"col-lg-4"},r={class:"list-unstyled"},d={class:"border-bottom h4 d-flex justify-content-between"},u=(0,a._)("div",null,"訂單明細",-1),p=(0,a._)("i",{class:"far fa-edit"},null,-1),m=(0,a.Uk)(" 修改 "),f=[p,m],h={key:0,style:{"max-height":"500px","overflow-y":"auto"}},g={class:"row g-0"},_={class:"col-4 col-md-3 col-lg-4"},b=["src"],v={class:"col-8 col-md-9 col-lg-8 g-3 d-flex flex-column g-3 justify-content-between"},y={class:"card-body p-1 d-flex flex-column justify-content-between"},x={class:"fs-5 text-start d-flex justify-content-between"},w={class:"text-end"},k={class:"text-start mb-0"},C={class:"text-muted"},$={class:"mb-0 text-end fs-4"},D={key:1},S=(0,a._)("i",{class:"bi bi-info-square fs-1"},null,-1),j=(0,a._)("p",{class:"fs-7",style:{"letter-spacing":"2px"}},"購物車內沒有商品",-1),L=(0,a.Uk)("挑選商品 "),V={key:0,class:"list-unstyled"},Z={class:"input-group mb-3 pt-3 border-top"},U={key:0,type:"text",class:"form-control p-2",placeholder:"已套用優惠券",disabled:""},O=["disabled"],W=(0,a.Uk)(" 套用優惠券 "),T=(0,a._)("div",{class:"loading d-none fade"},null,-1),q=[W,T],z={key:0,class:"border-0 d-flex justify-content-between fs-4"},X=(0,a._)("p",{class:"p-1"},"總計",-1),E={class:"p-1"},N={key:1,class:"border-0 fs-4"},F={class:"fs-5 d-flex justify-content-between"},M=(0,a._)("p",{class:"p-1"},"總計",-1),H={class:"p-1"},Y={class:"d-flex justify-content-between"},I=(0,a._)("p",{class:"p-1"},"折扣後金額：",-1),P={class:"fs-4"},B={class:"col-lg-8 justify-content-center text-start"},K=(0,a._)("div",{class:"text-start h2 border-bottom-0"},"訂購人資訊",-1),R={class:"mb-3"},A=(0,a._)("label",{for:"email",class:"form-label"},[(0,a.Uk)("Email "),(0,a._)("span",{class:"text-danger"},"*")],-1),G={class:"mb-3"},J=(0,a._)("label",{for:"name",class:"form-label"},[(0,a.Uk)("收件人姓名 "),(0,a._)("span",{class:"text-danger"},"*")],-1),Q={class:"mb-3"},ee=(0,a._)("label",{for:"tel",class:"form-label"},[(0,a.Uk)("收件人電話 "),(0,a._)("span",{class:"text-danger"},"*")],-1),se={class:"mb-3"},te=(0,a._)("label",{for:"address",class:"form-label"},[(0,a.Uk)("收件人地址 "),(0,a._)("span",{class:"text-danger"},"*")],-1),ae={class:"mb-3"},le=(0,a._)("label",{for:"message",class:"form-label"},"留言",-1),ne=["disabled"],ie={class:"text-end"},oe=["disabled"];function ce(e,s,t,p,m,W){const T=(0,a.up)("LoadingComponent"),ce=(0,a.up)("VLoading"),re=(0,a.up)("StepStatusComponent"),de=(0,a.up)("RouterLink"),ue=(0,a.up)("VField"),pe=(0,a.up)("ErrorMessage"),me=(0,a.up)("VForm");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(ce,{active:m.isLoading,"z-index":1060},{default:(0,a.w5)((()=>[(0,a.Wm)(T)])),_:1},8,["active"]),(0,a._)("div",i,[(0,a.Wm)(re,{"step-status":m.stepStatus},null,8,["step-status"]),m.stepStatus.createOrder?((0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",c,[(0,a._)("ul",r,[(0,a._)("li",d,[u,(0,a._)("button",{type:"button",class:"btn border-0",onClick:s[0]||(s[0]=(...e)=>W.openOffcanvas&&W.openOffcanvas(...e))},f)]),m.carts.carts?.length>0?((0,a.wg)(),(0,a.iD)("div",h,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(m.carts.carts,(e=>((0,a.wg)(),(0,a.iD)("li",{class:"card border-0 p-3",key:e.id+"123"},[(0,a._)("div",g,[(0,a._)("div",_,[(0,a._)("img",{src:e.product.imageUrl,class:"img-fluid",style:{"object-fit":"contain"},alt:"cart.product.title"},null,8,b)]),(0,a._)("div",v,[(0,a._)("div",y,[(0,a._)("div",x,[(0,a._)("p",null,(0,l.zw)(e.product.title),1),(0,a._)("small",w,"X"+(0,l.zw)(e.qty),1)]),(0,a._)("p",k,[(0,a._)("small",C,"NT$"+(0,l.zw)(W.toThousandths(e.product.price))+" / "+(0,l.zw)(e.product.unit),1)]),(0,a._)("p",$," NT$"+(0,l.zw)(W.toThousandths(e.qty*e.product.price)),1)])])])])))),128))])):((0,a.wg)(),(0,a.iD)("div",D,[S,j,(0,a.Wm)(de,{to:"/products",class:"btn btn-primary py-2 px-4"},{default:(0,a.w5)((()=>[L])),_:1})]))]),m.carts.carts?.length>0?((0,a.wg)(),(0,a.iD)("ul",V,[(0,a._)("li",Z,[m.isCoupon?((0,a.wg)(),(0,a.iD)("input",U)):(0,a.wy)(((0,a.wg)(),(0,a.iD)("input",{key:1,type:"text",class:"form-control p-2",placeholder:"輸入優惠碼","onUpdate:modelValue":s[1]||(s[1]=e=>m.code=e)},null,512)),[[n.nr,m.code]]),(0,a._)("button",{type:"button",class:"btn btn-primary px-3",disabled:m.isCoupon,onClick:s[2]||(s[2]=e=>W.useCoupon(m.code))},q,8,O)]),m.isCoupon?((0,a.wg)(),(0,a.iD)("li",N,[(0,a._)("small",F,[M,(0,a._)("del",H,"NT$"+(0,l.zw)(W.toThousandths(m.carts.total)),1)]),(0,a._)("div",Y,[I,(0,a._)("span",P,"$ "+(0,l.zw)(W.toThousandths(Math.round(m.carts.final_total)))+" NTD",1)])])):((0,a.wg)(),(0,a.iD)("li",z,[X,(0,a._)("p",E,"NT$"+(0,l.zw)(W.toThousandths(m.carts.final_total)),1)]))])):(0,a.kq)("",!0)]),(0,a._)("div",B,[K,(0,a.Wm)(me,{ref:"form",onSubmit:W.checkOrder},{default:(0,a.w5)((({errors:e})=>[(0,a._)("div",R,[A,(0,a.Wm)(ue,{id:"email",name:"email",type:"email",class:(0,l.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"required|email",modelValue:m.form.user.email,"onUpdate:modelValue":s[3]||(s[3]=e=>m.form.user.email=e),disabled:0===m.carts.carts?.length},null,8,["class","modelValue","disabled"]),(0,a.Wm)(pe,{name:"email",class:"invalid-feedback"})]),(0,a._)("div",G,[J,(0,a.Wm)(ue,{id:"name",name:"姓名",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:m.form.user.name,"onUpdate:modelValue":s[4]||(s[4]=e=>m.form.user.name=e),disabled:0===m.carts.carts?.length},null,8,["class","modelValue","disabled"]),(0,a.Wm)(pe,{name:"姓名",class:"invalid-feedback"})]),(0,a._)("div",Q,[ee,(0,a.Wm)(ue,{id:"tel",name:"手機",type:"tel",class:(0,l.C_)(["form-control",{"is-invalid":e["手機"]}]),placeholder:"請輸入手機",rules:W.isPhone,modelValue:m.form.user.tel,"onUpdate:modelValue":s[5]||(s[5]=e=>m.form.user.tel=e),disabled:0===m.carts.carts?.length},null,8,["class","rules","modelValue","disabled"]),(0,a.Wm)(pe,{name:"手機",class:"invalid-feedback"})]),(0,a._)("div",se,[te,(0,a.Wm)(ue,{id:"address",name:"地址",type:"text",class:(0,l.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:m.form.user.address,"onUpdate:modelValue":s[6]||(s[6]=e=>m.form.user.address=e),disabled:0===m.carts.carts?.length},null,8,["class","modelValue","disabled"]),(0,a.Wm)(pe,{name:"地址",class:"invalid-feedback"})]),(0,a._)("div",ae,[le,(0,a.wy)((0,a._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":s[7]||(s[7]=e=>m.form.user.message=e),disabled:0===m.carts.carts?.length},null,8,ne),[[n.nr,m.form.user.message]])]),(0,a._)("div",ie,[(0,a._)("button",{type:"submit",class:"btn btn-primary mb-3",disabled:Object.keys(e).length>0||0===m.carts.carts?.length}," 送出訂單 ",8,oe)])])),_:1},8,["onSubmit"])])])):(0,a.kq)("",!0)])],64)}var re=t(4902),de=t(143),ue=t(4427),pe=t(908),me={components:{LoadingComponent:de.Z,StepStatusComponent:ue.Z},data(){return{carts:{},isLoadingItem:"",form:{user:{name:"",email:"",tel:"",address:"",message:""}},isLoading:!1,isCoupon:!1,code:"",stepStatus:{createOrder:!0,payCheck:!1,success:!1},order:{}}},watch:{carts(e){e.final_total!==e.total?this.isCoupon=!0:this.isCoupon=!1,0===this.carts.carts?.length&&(re.Z.emit("push-message",{style:"info",title:"購物車無商品",content:"購物車沒東西了～\n頁面即將跳轉回商店"}),setTimeout((()=>{re.Z.emit("emit-close-offcanvas"),this.$router.push("/products")}),1500))}},methods:{DateFn:pe.D,toThousandths:pe.$E,getCarts(){const e="https://vue3-course-api.hexschool.io/v2/api/clothes/cart/";this.isLoading=!0,this.$http.get(e).then((e=>{this.carts=e.data.data,this.isLoading=!1})).catch((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"danger",title:`${e.response.data.message}`})}))},useCoupon(e){this.isLoading=!0;const s="https://vue3-course-api.hexschool.io/v2/api/clothes/coupon",t={code:e};this.$http.post(s,{data:t}).then((s=>{this.isLoading=!1,this.isCoupon=!0,this.code=e,re.Z.emit("push-message",{style:"success",title:`${s.data.message}`}),this.getCarts()})).catch((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"danger",title:`${e.response.data.message}`})}))},sendOrder(){this.isLoading=!0;const e="https://vue3-course-api.hexschool.io/v2/api/clothes/order",s=this.form;this.$http.post(e,{data:s}).then((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"success",title:`${e.data.message}`}),this.order=e.data,re.Z.emit("get-cart-num"),this.$router.push(`/checkout/${this.order.orderId}`)})).catch((e=>{this.isLoading=!1,re.Z.emit("push-message",{style:"success",title:`${e.response.data.message}`})}))},checkOrder(){this.stepStatus.createOrder=!1,this.stepStatus.payCheck=!0,this.sendOrder()},isPhone(e){const s=/^(09)[0-9]{8}$/;return!!s.test(e)||"請輸入正確的電話號碼: ex:09XXXXXXXX"},openOffcanvas(){re.Z.emit("emit-open-offcanvas")}},mounted(){this.getCarts(),re.Z.on("get-checkout-cart",this.getCarts)}},fe=t(3744);const he=(0,fe.Z)(me,[["render",ce]]);var ge=he}}]);
//# sourceMappingURL=606.d341d919.js.map